{{ define "main" }}
<article class="moments-page">
  <section class="moments-body">
    {{ if .Content }}
      <div class="moments-intro">
        {{ .Content }}
      </div>
    {{ end }}

    {{ $items := site.Data.moments.items | default (slice) }}
    {{ $currentYear := "" }}
    {{ range $items }}
      {{ if ne .year $currentYear }}
        {{ if ne $currentYear "" }}
          </div>
        </section>
        {{ end }}
        {{ $currentYear = .year }}
        {{ $yearDocs := where $items "year" .year }}
        <section class="moments-year">
          <div class="moments-year-head">
            <h2 class="moments-year-title">{{ .year }} 年</h2>
            <span class="moments-year-count">{{ len $yearDocs }} 份</span>
          </div>
          <div class="moments-grid">
      {{ end }}
            <a class="moments-card" href="{{ .url }}" download>
              <div class="moments-card-title">{{ .title }}</div>
              <div class="moments-card-meta">{{ upper .ext }} · {{ printf "%.1f" .size_mb }} MB</div>
            </a>
    {{ end }}
    {{ if ne $currentYear "" }}
          </div>
        </section>
    {{ end }}
  </section>
</article>
{{ end }}
